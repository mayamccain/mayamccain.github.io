<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Maya McCain">

<title>Lab 8: Hyperparameter Tuning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hyperparameter-tuning_files/libs/clipboard/clipboard.min.js"></script>
<script src="hyperparameter-tuning_files/libs/quarto-html/quarto.js"></script>
<script src="hyperparameter-tuning_files/libs/quarto-html/popper.min.js"></script>
<script src="hyperparameter-tuning_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hyperparameter-tuning_files/libs/quarto-html/anchor.min.js"></script>
<link href="hyperparameter-tuning_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hyperparameter-tuning_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hyperparameter-tuning_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hyperparameter-tuning_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hyperparameter-tuning_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 8: Hyperparameter Tuning</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Maya McCain </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="data-importtidytransform" class="level1">
<h1>Data Import/Tidy/Transform</h1>
<section id="library-loading" class="level2">
<h2 class="anchored" data-anchor-id="library-loading">Library Loading</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ────────────────────────────────────── tidymodels 1.3.0 ──
✔ broom        1.0.7     ✔ rsample      1.2.1
✔ dials        1.4.0     ✔ tune         1.3.0
✔ infer        1.0.7     ✔ workflows    1.2.0
✔ modeldata    1.4.0     ✔ workflowsets 1.1.0
✔ parsnip      1.3.0     ✔ yardstick    1.3.2
✔ recipes      1.1.1     
── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──
✖ scales::discard() masks purrr::discard()
✖ dplyr::filter()   masks stats::filter()
✖ recipes::fixed()  masks stringr::fixed()
✖ dplyr::lag()      masks stats::lag()
✖ yardstick::spec() masks readr::spec()
✖ recipes::step()   masks stats::step()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(powerjoin)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'vip'

The following object is masked from 'package:utils':

    vi</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(baguette)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-ingest" class="level2">
<h2 class="anchored" data-anchor-id="data-ingest">Data Ingest</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>root  <span class="ot">&lt;-</span> <span class="st">'https://gdex.ucar.edu/dataset/camels/file'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(<span class="st">'https://gdex.ucar.edu/dataset/camels/file/camels_attributes_v2.0.pdf'</span>, </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">'data/camels_attributes_v2.0.pdf'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>types <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"clim"</span>, <span class="st">"geol"</span>, <span class="st">"soil"</span>, <span class="st">"topo"</span>, <span class="st">"vege"</span>, <span class="st">"hydro"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Where the files live online ...</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>remote_files  <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">'{root}/camels_{types}.txt'</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># where we want to download the data ...</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>local_files   <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">'data/camels_{types}.txt'</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">walk2</span>(remote_files, local_files, download.file, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and merge data</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>camels <span class="ot">&lt;-</span> <span class="fu">map</span>(local_files, read_delim, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>camels <span class="ot">&lt;-</span> <span class="fu">power_full_join</span>(camels, <span class="at">by =</span> <span class="st">'gauge_id'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">Data Cleaning</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(camels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 671
Columns: 58
$ gauge_id             &lt;chr&gt; "01013500", "01022500", "01030500", "01031500", "…
$ p_mean               &lt;dbl&gt; 3.126679, 3.608126, 3.274405, 3.522957, 3.323146,…
$ pet_mean             &lt;dbl&gt; 1.971555, 2.119256, 2.043594, 2.071324, 2.090024,…
$ p_seasonality        &lt;dbl&gt; 0.187940259, -0.114529586, 0.047358189, 0.1040905…
$ frac_snow            &lt;dbl&gt; 0.3134404, 0.2452590, 0.2770184, 0.2918365, 0.280…
$ aridity              &lt;dbl&gt; 0.6305587, 0.5873564, 0.6241114, 0.5879503, 0.628…
$ high_prec_freq       &lt;dbl&gt; 12.95, 20.55, 17.15, 18.90, 20.10, 13.50, 17.50, …
$ high_prec_dur        &lt;dbl&gt; 1.348958, 1.205279, 1.207746, 1.148936, 1.165217,…
$ high_prec_timing     &lt;chr&gt; "son", "son", "son", "son", "son", "jja", "son", …
$ low_prec_freq        &lt;dbl&gt; 202.20, 233.65, 215.60, 227.35, 235.90, 193.50, 2…
$ low_prec_dur         &lt;dbl&gt; 3.427119, 3.662226, 3.514262, 3.473644, 3.691706,…
$ low_prec_timing      &lt;chr&gt; "mam", "jja", "djf", "djf", "djf", "mam", "mam", …
$ geol_1st_class       &lt;chr&gt; "Siliciclastic sedimentary rocks", "Acid plutonic…
$ glim_1st_class_frac  &lt;dbl&gt; 0.8159044, 0.5906582, 0.5733054, 0.4489279, 0.308…
$ geol_2nd_class       &lt;chr&gt; "Basic volcanic rocks", "Siliciclastic sedimentar…
$ glim_2nd_class_frac  &lt;dbl&gt; 0.17972945, 0.16461821, 0.28701001, 0.44386282, 0…
$ carbonate_rocks_frac &lt;dbl&gt; 0.000000000, 0.000000000, 0.052140094, 0.02625797…
$ geol_porostiy        &lt;dbl&gt; 0.1714, 0.0710, 0.1178, 0.0747, 0.0522, 0.0711, 0…
$ geol_permeability    &lt;dbl&gt; -14.7019, -14.2138, -14.4918, -14.8410, -14.4819,…
$ soil_depth_pelletier &lt;dbl&gt; 7.4047619, 17.4128079, 19.0114144, 7.2525570, 5.3…
$ soil_depth_statsgo   &lt;dbl&gt; 1.248408, 1.491846, 1.461363, 1.279047, 1.392779,…
$ soil_porosity        &lt;dbl&gt; 0.4611488, 0.4159055, 0.4590910, 0.4502360, 0.422…
$ soil_conductivity    &lt;dbl&gt; 1.106522, 2.375005, 1.289807, 1.373292, 2.615154,…
$ max_water_content    &lt;dbl&gt; 0.5580548, 0.6262289, 0.6530198, 0.5591227, 0.561…
$ sand_frac            &lt;dbl&gt; 27.84183, 59.39016, 32.23546, 35.26903, 55.16313,…
$ silt_frac            &lt;dbl&gt; 55.15694, 28.08094, 51.77918, 50.84123, 34.18544,…
$ clay_frac            &lt;dbl&gt; 16.275732, 12.037646, 14.776824, 12.654125, 10.30…
$ water_frac           &lt;dbl&gt; 5.3766978, 1.2269127, 1.6343449, 0.6745936, 0.000…
$ organic_frac         &lt;dbl&gt; 0.4087168, 0.0000000, 1.3302776, 0.0000000, 0.000…
$ other_frac           &lt;dbl&gt; 0.0000000, 0.3584723, 0.0220161, 0.0000000, 0.147…
$ gauge_lat            &lt;dbl&gt; 47.23739, 44.60797, 45.50097, 45.17501, 44.86920,…
$ gauge_lon            &lt;dbl&gt; -68.58264, -67.93524, -68.30596, -69.31470, -69.9…
$ elev_mean            &lt;dbl&gt; 250.31, 92.68, 143.80, 247.80, 310.38, 615.70, 47…
$ slope_mean           &lt;dbl&gt; 21.64152, 17.79072, 12.79195, 29.56035, 49.92122,…
$ area_gages2          &lt;dbl&gt; 2252.70, 573.60, 3676.17, 769.05, 909.10, 383.82,…
$ area_geospa_fabric   &lt;dbl&gt; 2303.95, 620.38, 3676.09, 766.53, 904.94, 396.10,…
$ frac_forest          &lt;dbl&gt; 0.9063, 0.9232, 0.8782, 0.9548, 0.9906, 1.0000, 1…
$ lai_max              &lt;dbl&gt; 4.167304, 4.871392, 4.685200, 4.903259, 5.086811,…
$ lai_diff             &lt;dbl&gt; 3.340732, 3.746692, 3.665543, 3.990843, 4.300978,…
$ gvf_max              &lt;dbl&gt; 0.8045674, 0.8639358, 0.8585020, 0.8706685, 0.891…
$ gvf_diff             &lt;dbl&gt; 0.3716482, 0.3377125, 0.3513934, 0.3986194, 0.445…
$ dom_land_cover_frac  &lt;dbl&gt; 0.8834519, 0.8204934, 0.9752580, 1.0000000, 0.850…
$ dom_land_cover       &lt;chr&gt; "    Mixed Forests", "    Mixed Forests", "    Mi…
$ root_depth_50        &lt;dbl&gt; NA, 0.2374345, NA, 0.2500000, 0.2410270, 0.225615…
$ root_depth_99        &lt;dbl&gt; NA, 2.238444, NA, 2.400000, 2.340180, 2.237435, 2…
$ q_mean               &lt;dbl&gt; 1.699155, 2.173062, 1.820108, 2.030242, 2.182870,…
$ runoff_ratio         &lt;dbl&gt; 0.5434375, 0.6022689, 0.5558590, 0.5762893, 0.656…
$ slope_fdc            &lt;dbl&gt; 1.528219, 1.776280, 1.871110, 1.494019, 1.415939,…
$ baseflow_index       &lt;dbl&gt; 0.5852260, 0.5544784, 0.5084407, 0.4450905, 0.473…
$ stream_elas          &lt;dbl&gt; 1.8453242, 1.7027824, 1.3775052, 1.6486930, 1.510…
$ q5                   &lt;dbl&gt; 0.24110613, 0.20473436, 0.10714920, 0.11134535, 0…
$ q95                  &lt;dbl&gt; 6.373021, 7.123049, 6.854887, 8.010503, 8.095148,…
$ high_q_freq          &lt;dbl&gt; 6.10, 3.90, 12.25, 18.90, 14.95, 14.10, 16.05, 16…
$ high_q_dur           &lt;dbl&gt; 8.714286, 2.294118, 7.205882, 3.286957, 2.577586,…
$ low_q_freq           &lt;dbl&gt; 41.35, 65.15, 89.25, 94.80, 71.55, 58.90, 82.20, …
$ low_q_dur            &lt;dbl&gt; 20.170732, 17.144737, 19.402174, 14.697674, 12.77…
$ zero_q_freq          &lt;dbl&gt; 0.00000000, 0.00000000, 0.00000000, 0.00000000, 0…
$ hfd_mean             &lt;dbl&gt; 207.25, 166.25, 184.90, 181.00, 184.80, 197.20, 1…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(camels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">camels</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">671</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">58</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">52</td>
</tr>
<tr class="even">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 22%">
<col style="width: 13%">
<col style="width: 18%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">gauge_id</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">671</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">high_prec_timing</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">low_prec_timing</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">geol_1st_class</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geol_2nd_class</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">dom_land_cover</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">p_mean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3.26</td>
<td style="text-align: right;">1.41</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">2.37</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">3.78</td>
<td style="text-align: right;">8.94</td>
<td style="text-align: left;">▃▇▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">pet_mean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.79</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">1.90</td>
<td style="text-align: right;">2.34</td>
<td style="text-align: right;">2.69</td>
<td style="text-align: right;">3.15</td>
<td style="text-align: right;">4.74</td>
<td style="text-align: left;">▇▇▅▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">p_seasonality</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-0.04</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">-1.44</td>
<td style="text-align: right;">-0.26</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: left;">▁▂▃▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">frac_snow</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">aridity</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.06</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">1.27</td>
<td style="text-align: right;">5.21</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">high_prec_freq</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">20.93</td>
<td style="text-align: right;">4.55</td>
<td style="text-align: right;">7.90</td>
<td style="text-align: right;">18.50</td>
<td style="text-align: right;">22.00</td>
<td style="text-align: right;">24.23</td>
<td style="text-align: right;">32.70</td>
<td style="text-align: left;">▂▃▇▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">high_prec_dur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">1.44</td>
<td style="text-align: right;">2.09</td>
<td style="text-align: left;">▇▅▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">low_prec_freq</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">254.65</td>
<td style="text-align: right;">35.12</td>
<td style="text-align: right;">169.90</td>
<td style="text-align: right;">232.70</td>
<td style="text-align: right;">255.85</td>
<td style="text-align: right;">278.92</td>
<td style="text-align: right;">348.70</td>
<td style="text-align: left;">▂▅▇▅▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">low_prec_dur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5.95</td>
<td style="text-align: right;">3.20</td>
<td style="text-align: right;">2.79</td>
<td style="text-align: right;">4.24</td>
<td style="text-align: right;">4.95</td>
<td style="text-align: right;">6.70</td>
<td style="text-align: right;">36.51</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">glim_1st_class_frac</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▁▃▃▃▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">glim_2nd_class_frac</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: left;">▇▃▃▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">carbonate_rocks_frac</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">geol_porostiy</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: left;">▇▆▇▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">geol_permeability</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-13.89</td>
<td style="text-align: right;">1.18</td>
<td style="text-align: right;">-16.50</td>
<td style="text-align: right;">-14.77</td>
<td style="text-align: right;">-13.96</td>
<td style="text-align: right;">-13.00</td>
<td style="text-align: right;">-10.90</td>
<td style="text-align: left;">▂▅▇▅▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">soil_depth_pelletier</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">10.87</td>
<td style="text-align: right;">16.24</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.23</td>
<td style="text-align: right;">12.89</td>
<td style="text-align: right;">50.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">soil_depth_statsgo</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.29</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">1.11</td>
<td style="text-align: right;">1.46</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: left;">▁▁▂▂▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">soil_porosity</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: left;">▃▇▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">soil_conductivity</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.74</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">0.45</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">1.93</td>
<td style="text-align: right;">13.96</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">max_water_content</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.09</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.56</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: left;">▁▅▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">sand_frac</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">36.47</td>
<td style="text-align: right;">15.63</td>
<td style="text-align: right;">8.18</td>
<td style="text-align: right;">25.44</td>
<td style="text-align: right;">35.27</td>
<td style="text-align: right;">44.46</td>
<td style="text-align: right;">91.98</td>
<td style="text-align: left;">▅▇▅▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">silt_frac</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">33.86</td>
<td style="text-align: right;">13.25</td>
<td style="text-align: right;">2.99</td>
<td style="text-align: right;">23.95</td>
<td style="text-align: right;">34.06</td>
<td style="text-align: right;">43.64</td>
<td style="text-align: right;">67.77</td>
<td style="text-align: left;">▂▆▇▆▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">clay_frac</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">19.89</td>
<td style="text-align: right;">9.32</td>
<td style="text-align: right;">1.85</td>
<td style="text-align: right;">14.00</td>
<td style="text-align: right;">18.66</td>
<td style="text-align: right;">25.42</td>
<td style="text-align: right;">50.35</td>
<td style="text-align: left;">▃▇▅▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">water_frac</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">19.35</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">organic_frac</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">3.84</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">57.86</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">other_frac</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">9.82</td>
<td style="text-align: right;">16.83</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.31</td>
<td style="text-align: right;">11.74</td>
<td style="text-align: right;">99.38</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">gauge_lat</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">39.24</td>
<td style="text-align: right;">5.21</td>
<td style="text-align: right;">27.05</td>
<td style="text-align: right;">35.70</td>
<td style="text-align: right;">39.25</td>
<td style="text-align: right;">43.21</td>
<td style="text-align: right;">48.82</td>
<td style="text-align: left;">▂▃▇▆▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gauge_lon</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">-95.79</td>
<td style="text-align: right;">16.21</td>
<td style="text-align: right;">-124.39</td>
<td style="text-align: right;">-110.41</td>
<td style="text-align: right;">-92.78</td>
<td style="text-align: right;">-81.77</td>
<td style="text-align: right;">-67.94</td>
<td style="text-align: left;">▆▃▇▇▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">elev_mean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">759.42</td>
<td style="text-align: right;">786.00</td>
<td style="text-align: right;">10.21</td>
<td style="text-align: right;">249.67</td>
<td style="text-align: right;">462.72</td>
<td style="text-align: right;">928.88</td>
<td style="text-align: right;">3571.18</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">slope_mean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">46.20</td>
<td style="text-align: right;">47.12</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: right;">7.43</td>
<td style="text-align: right;">28.80</td>
<td style="text-align: right;">73.17</td>
<td style="text-align: right;">255.69</td>
<td style="text-align: left;">▇▂▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">area_gages2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">792.62</td>
<td style="text-align: right;">1701.95</td>
<td style="text-align: right;">4.03</td>
<td style="text-align: right;">122.28</td>
<td style="text-align: right;">329.68</td>
<td style="text-align: right;">794.30</td>
<td style="text-align: right;">25791.04</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">area_geospa_fabric</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">808.08</td>
<td style="text-align: right;">1709.85</td>
<td style="text-align: right;">4.10</td>
<td style="text-align: right;">127.98</td>
<td style="text-align: right;">340.70</td>
<td style="text-align: right;">804.50</td>
<td style="text-align: right;">25817.78</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">frac_forest</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▃▁▁▂▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lai_max</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">3.22</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">1.81</td>
<td style="text-align: right;">3.37</td>
<td style="text-align: right;">4.70</td>
<td style="text-align: right;">5.58</td>
<td style="text-align: left;">▅▆▃▅▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">lai_diff</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.45</td>
<td style="text-align: right;">1.33</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">2.34</td>
<td style="text-align: right;">3.76</td>
<td style="text-align: right;">4.83</td>
<td style="text-align: left;">▇▇▇▆▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gvf_max</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: left;">▁▁▂▃▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">gvf_diff</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: left;">▃▇▅▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dom_land_cover_frac</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.86</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▁▂▃▃▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">root_depth_50</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.12</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.18</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: left;">▃▃▇▂▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">root_depth_99</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">0.30</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">1.52</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">3.10</td>
<td style="text-align: left;">▇▃▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">q_mean</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.49</td>
<td style="text-align: right;">1.54</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">1.13</td>
<td style="text-align: right;">1.75</td>
<td style="text-align: right;">9.69</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">runoff_ratio</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.39</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.24</td>
<td style="text-align: right;">0.35</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">1.36</td>
<td style="text-align: left;">▆▇▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">slope_fdc</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.24</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.90</td>
<td style="text-align: right;">1.28</td>
<td style="text-align: right;">1.63</td>
<td style="text-align: right;">2.50</td>
<td style="text-align: left;">▂▅▇▇▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">baseflow_index</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.49</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: left;">▁▃▇▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">stream_elas</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">0.78</td>
<td style="text-align: right;">-0.64</td>
<td style="text-align: right;">1.32</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">2.23</td>
<td style="text-align: right;">6.24</td>
<td style="text-align: left;">▁▇▃▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">q5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">q95</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5.06</td>
<td style="text-align: right;">4.94</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2.07</td>
<td style="text-align: right;">3.77</td>
<td style="text-align: right;">6.29</td>
<td style="text-align: right;">31.82</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">high_q_freq</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">25.74</td>
<td style="text-align: right;">29.07</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">6.41</td>
<td style="text-align: right;">15.10</td>
<td style="text-align: right;">35.79</td>
<td style="text-align: right;">172.80</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">high_q_dur</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">6.91</td>
<td style="text-align: right;">10.07</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.82</td>
<td style="text-align: right;">2.85</td>
<td style="text-align: right;">7.55</td>
<td style="text-align: right;">92.56</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">low_q_freq</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">107.62</td>
<td style="text-align: right;">82.24</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">37.44</td>
<td style="text-align: right;">96.00</td>
<td style="text-align: right;">162.14</td>
<td style="text-align: right;">356.80</td>
<td style="text-align: left;">▇▆▅▂▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">low_q_dur</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">22.28</td>
<td style="text-align: right;">21.66</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">15.52</td>
<td style="text-align: right;">26.91</td>
<td style="text-align: right;">209.88</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">zero_q_freq</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.97</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">hfd_mean</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">182.52</td>
<td style="text-align: right;">33.53</td>
<td style="text-align: right;">112.25</td>
<td style="text-align: right;">160.16</td>
<td style="text-align: right;">173.77</td>
<td style="text-align: right;">204.05</td>
<td style="text-align: right;">287.75</td>
<td style="text-align: left;">▂▇▃▂▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>visdat<span class="sc">::</span><span class="fu">vis_dat</span>(camels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hyperparameter-tuning_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>camels <span class="ot">&lt;-</span> camels <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(camels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 507
Columns: 58
$ gauge_id             &lt;chr&gt; "01022500", "01031500", "01047000", "01052500", "…
$ p_mean               &lt;dbl&gt; 3.608126, 3.522957, 3.323146, 3.730858, 4.067132,…
$ pet_mean             &lt;dbl&gt; 2.119256, 2.071324, 2.090024, 2.096423, 2.128355,…
$ p_seasonality        &lt;dbl&gt; -0.11452959, 0.10409060, 0.14777561, 0.15209680, …
$ frac_snow            &lt;dbl&gt; 0.2452590, 0.2918365, 0.2801181, 0.3526983, 0.299…
$ aridity              &lt;dbl&gt; 0.5873564, 0.5879503, 0.6289293, 0.5619145, 0.523…
$ high_prec_freq       &lt;dbl&gt; 20.55, 18.90, 20.10, 13.50, 17.50, 19.15, 20.35, …
$ high_prec_dur        &lt;dbl&gt; 1.205279, 1.148936, 1.165217, 1.129707, 1.194539,…
$ high_prec_timing     &lt;chr&gt; "son", "son", "son", "jja", "son", "son", "son", …
$ low_prec_freq        &lt;dbl&gt; 233.65, 227.35, 235.90, 193.50, 220.30, 224.85, 2…
$ low_prec_dur         &lt;dbl&gt; 3.662226, 3.473644, 3.691706, 2.896707, 3.263704,…
$ low_prec_timing      &lt;chr&gt; "jja", "djf", "djf", "mam", "mam", "mam", "djf", …
$ geol_1st_class       &lt;chr&gt; "Acid plutonic rocks", "Siliciclastic sedimentary…
$ glim_1st_class_frac  &lt;dbl&gt; 0.5906582, 0.4489279, 0.3084880, 0.4974583, 0.871…
$ geol_2nd_class       &lt;chr&gt; "Siliciclastic sedimentary rocks", "Metamorphics"…
$ glim_2nd_class_frac  &lt;dbl&gt; 0.1646182103, 0.4438628245, 0.2886125463, 0.37406…
$ carbonate_rocks_frac &lt;dbl&gt; 0.000000000, 0.026257979, 0.000000000, 0.00000000…
$ geol_porostiy        &lt;dbl&gt; 0.0710, 0.0747, 0.0522, 0.0711, 0.0288, 0.1455, 0…
$ geol_permeability    &lt;dbl&gt; -14.2138, -14.8410, -14.4819, -15.1658, -14.2147,…
$ soil_depth_pelletier &lt;dbl&gt; 17.4128079, 7.2525570, 5.3596549, 1.3013493, 0.91…
$ soil_depth_statsgo   &lt;dbl&gt; 1.4918455, 1.2790469, 1.3927785, 1.4948074, 1.477…
$ soil_porosity        &lt;dbl&gt; 0.4159055, 0.4502360, 0.4227490, 0.4523257, 0.418…
$ soil_conductivity    &lt;dbl&gt; 2.375005, 1.373292, 2.615154, 1.262995, 2.919142,…
$ max_water_content    &lt;dbl&gt; 0.6262289, 0.5591227, 0.5611808, 0.6155380, 0.594…
$ sand_frac            &lt;dbl&gt; 59.39016, 35.26903, 55.16313, 30.55767, 58.37617,…
$ silt_frac            &lt;dbl&gt; 28.08094, 50.84123, 34.18544, 52.61465, 31.83647,…
$ clay_frac            &lt;dbl&gt; 12.037646, 12.654125, 10.303622, 11.143326, 9.851…
$ water_frac           &lt;dbl&gt; 1.22691267, 0.67459358, 0.00000000, 0.00000000, 0…
$ organic_frac         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ other_frac           &lt;dbl&gt; 0.3584723, 0.0000000, 0.1478672, 5.6755267, 0.000…
$ gauge_lat            &lt;dbl&gt; 44.60797, 45.17501, 44.86920, 44.87739, 44.39044,…
$ gauge_lon            &lt;dbl&gt; -67.93524, -69.31470, -69.95510, -71.05749, -70.9…
$ elev_mean            &lt;dbl&gt; 92.68, 247.80, 310.38, 615.70, 472.31, 423.12, 21…
$ slope_mean           &lt;dbl&gt; 17.79072, 29.56035, 49.92122, 60.05183, 90.13951,…
$ area_gages2          &lt;dbl&gt; 573.60, 769.05, 909.10, 383.82, 180.98, 250.64, 1…
$ area_geospa_fabric   &lt;dbl&gt; 620.38, 766.53, 904.94, 396.10, 181.33, 251.16, 1…
$ frac_forest          &lt;dbl&gt; 0.9232, 0.9548, 0.9906, 1.0000, 1.0000, 0.9916, 0…
$ lai_max              &lt;dbl&gt; 4.871392, 4.903259, 5.086811, 4.800830, 5.019827,…
$ lai_diff             &lt;dbl&gt; 3.746692, 3.990843, 4.300978, 4.124313, 4.283551,…
$ gvf_max              &lt;dbl&gt; 0.8639358, 0.8706685, 0.8913828, 0.8800341, 0.886…
$ gvf_diff             &lt;dbl&gt; 0.3377125, 0.3986194, 0.4454732, 0.4773279, 0.455…
$ dom_land_cover_frac  &lt;dbl&gt; 0.8204934, 1.0000000, 0.8504500, 0.5935884, 0.580…
$ dom_land_cover       &lt;chr&gt; "    Mixed Forests", "    Mixed Forests", "    Mi…
$ root_depth_50        &lt;dbl&gt; 0.2374345, 0.2500000, 0.2410270, 0.2256153, 0.224…
$ root_depth_99        &lt;dbl&gt; 2.238444, 2.400000, 2.340180, 2.237435, 2.232382,…
$ q_mean               &lt;dbl&gt; 2.173062, 2.030242, 2.182870, 2.405105, 2.731742,…
$ runoff_ratio         &lt;dbl&gt; 0.6022689, 0.5762893, 0.6568684, 0.6446518, 0.671…
$ slope_fdc            &lt;dbl&gt; 1.776280, 1.494019, 1.415939, 1.301062, 1.319645,…
$ baseflow_index       &lt;dbl&gt; 0.5544784, 0.4450905, 0.4734649, 0.4596999, 0.437…
$ stream_elas          &lt;dbl&gt; 1.7027824, 1.6486930, 1.5102375, 1.0255555, 1.357…
$ q5                   &lt;dbl&gt; 0.20473436, 0.11134535, 0.19645805, 0.30596536, 0…
$ q95                  &lt;dbl&gt; 7.123049, 8.010503, 8.095148, 8.669019, 10.095605…
$ high_q_freq          &lt;dbl&gt; 3.90, 18.90, 14.95, 14.10, 16.05, 16.25, 13.85, 7…
$ high_q_dur           &lt;dbl&gt; 2.294118, 3.286957, 2.577586, 2.517857, 1.888235,…
$ low_q_freq           &lt;dbl&gt; 65.15, 94.80, 71.55, 58.90, 82.20, 83.60, 82.95, …
$ low_q_dur            &lt;dbl&gt; 17.144737, 14.697674, 12.776786, 7.316770, 9.9636…
$ zero_q_freq          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
$ hfd_mean             &lt;dbl&gt; 166.25, 181.00, 184.80, 197.20, 183.45, 186.05, 1…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>visdat<span class="sc">::</span><span class="fu">vis_dat</span>(camels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hyperparameter-tuning_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="data-splitting" class="level1">
<h1>Data Splitting</h1>
<section id="initial-split" class="level2">
<h2 class="anchored" data-anchor-id="initial-split">Initial Split</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>camels <span class="ot">&lt;-</span> camels <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logQmean =</span> <span class="fu">log</span>(q_mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="testingtraining" class="level2">
<h2 class="anchored" data-anchor-id="testingtraining">Testing/Training</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>camels_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(camels, <span class="at">prop =</span> <span class="fl">0.8</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>camels_train <span class="ot">&lt;-</span> <span class="fu">training</span>(camels_split)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>camels_test  <span class="ot">&lt;-</span> <span class="fu">testing</span>(camels_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="feature-engineering" class="level1">
<h1>Feature Engineering</h1>
<section id="proper-recipe" class="level2">
<h2 class="anchored" data-anchor-id="proper-recipe">Proper Recipe</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(logQmean <span class="sc">~</span> slope_mean <span class="sc">+</span> runoff_ratio, <span class="at">data =</span> camels_train) <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_naomit</span>(<span class="fu">all_predictors</span>(), <span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_log</span>(slope_mean, runoff_ratio, <span class="at">offset =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_interact</span>(<span class="at">terms =</span> <span class="sc">~</span> slope_mean<span class="sc">:</span>runoff_ratio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-resampling-and-model-testing" class="level1">
<h1>Data Resampling and Model Testing</h1>
<section id="cross-validation-dataset-k-folds" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation-dataset-k-folds">Cross Validation Dataset (k-folds)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>camels_cv <span class="ot">&lt;-</span> <span class="fu">vfold_cv</span>(camels_train, <span class="at">v =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="define-three-regression-models" class="level2">
<h2 class="anchored" data-anchor-id="define-three-regression-models">Define Three Regression Models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest Model</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"randomForest"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># XGBoost Model</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>xgb_model <span class="ot">&lt;-</span> <span class="fu">boost_tree</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">'xgboost'</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Neural Network Model</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>nn_model <span class="ot">&lt;-</span> <span class="fu">mlp</span>() <span class="sc">|&gt;</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">'nnet'</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="workflow-setmapautoplot" class="level2">
<h2 class="anchored" data-anchor-id="workflow-setmapautoplot">Workflow Set/Map/Autoplot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>wf <span class="ot">&lt;-</span> <span class="fu">workflow_set</span>(<span class="fu">list</span>(rec), <span class="fu">list</span>(rf_model, xgb_model, nn_model)) <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow_map</span>(<span class="at">resamples =</span> camels_cv)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(wf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hyperparameter-tuning_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rank_results</span>(wf, <span class="at">rank_metric =</span> <span class="st">"rsq"</span>, <span class="at">select_best =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  wflow_id          .config .metric  mean std_err     n preprocessor model  rank
  &lt;chr&gt;             &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;        &lt;chr&gt; &lt;int&gt;
1 recipe_mlp        Prepro… rmse    0.270 0.0126     10 recipe       mlp       1
2 recipe_mlp        Prepro… rsq     0.950 0.00533    10 recipe       mlp       1
3 recipe_rand_fore… Prepro… rmse    0.282 0.0149     10 recipe       rand…     2
4 recipe_rand_fore… Prepro… rsq     0.945 0.00786    10 recipe       rand…     2
5 recipe_boost_tree Prepro… rmse    0.290 0.00981    10 recipe       boos…     3
6 recipe_boost_tree Prepro… rsq     0.942 0.00768    10 recipe       boos…     3</code></pre>
</div>
</div>
</section>
<section id="model-selection-with-justification" class="level2">
<h2 class="anchored" data-anchor-id="model-selection-with-justification">Model Selection with Justification</h2>
<p>The neural network model is the best model for looking at this relationship. As shown in the autoplot, the neural network model has an r-squared of about 0.94, which shows a higher correlation between mean slope and runoff ratio. The lower root mean squared error of about 0.255 shows that there is a higher correlation between the variables because there is less error.</p>
<p>The neural network model is based on the human brain in order to make predictions and identify patterns. It used the ‘nnet’ engine and the regression mode. This model likely performs well for stream flow prediction using slope and runoff ratio because it may be a nonlinear relationship, and the neural network model works well with these relationships. The neural network is also good at generalization and is good at adapting to different data. These qualities are useful when studying this relationship.</p>
</section>
</section>
<section id="model-tuning" class="level1">
<h1>Model Tuning</h1>
<section id="tunable-model-setup" class="level2">
<h2 class="anchored" data-anchor-id="tunable-model-setup">Tunable model setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>nn_parameter_model <span class="ot">&lt;-</span> <span class="fu">mlp</span>(<span class="at">hidden_units =</span> <span class="fu">tune</span>(), <span class="at">penalty =</span> <span class="fu">tune</span>()) <span class="sc">|&gt;</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">'nnet'</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tunable-workflow-defined" class="level2">
<h2 class="anchored" data-anchor-id="tunable-workflow-defined">Tunable workflow defined</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>nn_wf <span class="ot">&lt;-</span> <span class="fu">workflow</span>(rec, nn_parameter_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="description-of-dial-ranges" class="level2">
<h2 class="anchored" data-anchor-id="description-of-dial-ranges">Description of dial ranges</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dials <span class="ot">&lt;-</span> <span class="fu">extract_parameter_set_dials</span>(nn_wf)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>dials<span class="sc">$</span>object</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code># Hidden Units (quantitative)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Range: [1, 10]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Amount of Regularization (quantitative)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Transformer: log-10 [1e-100, Inf]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Range (transformed scale): [-10, 0]</code></pre>
</div>
</div>
</section>
<section id="defined-search-space" class="level2">
<h2 class="anchored" data-anchor-id="defined-search-space">Defined Search Space</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>my.grid <span class="ot">&lt;-</span> </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  nn_wf <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_parameter_set_dials</span>() <span class="sc">|&gt;</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid_space_filling</span>(<span class="at">size =</span> <span class="dv">25</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> my.grid <span class="sc">|&gt;</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(dropout, learn_rate)) <span class="sc">+</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="executed-tune-grid" class="level2">
<h2 class="anchored" data-anchor-id="executed-tune-grid">Executed Tune Grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>model_params <span class="ot">&lt;-</span>  <span class="fu">tune_grid</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    nn_wf,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamples =</span> camels_cv,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">grid =</span> my.grid,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(rmse, rsq, mae),</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">control_grid</span>(<span class="at">save_pred =</span> <span class="cn">TRUE</span>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(model_params)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hyperparameter-tuning_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Both hidden units and penalty (amount of regularization) have a high r-squared, a low root mean squared error, and relatively low mean absolute error. In general, the parameters performed well. A small to moderate number of hidden units and low dropout are ideal for this model.</p>
</section>
</section>
<section id="check-the-skill-of-the-tuned-model" class="level1">
<h1>Check the skill of the tuned model</h1>
<section id="collect-metricsshow-bestdescribe-in-plain-language" class="level2">
<h2 class="anchored" data-anchor-id="collect-metricsshow-bestdescribe-in-plain-language">Collect Metrics/Show Best/Describe in Plain Language</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mod_metrics <span class="ot">&lt;-</span> <span class="fu">collect_metrics</span>(model_params)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mod_metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 75 × 8
   hidden_units  penalty .metric .estimator  mean     n std_err .config         
          &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;           
 1            1 6.81e- 5 mae     standard   0.251    10 0.00993 Preprocessor1_M…
 2            1 6.81e- 5 rmse    standard   0.312    10 0.0114  Preprocessor1_M…
 3            1 6.81e- 5 rsq     standard   0.934    10 0.00545 Preprocessor1_M…
 4            1 8.25e- 8 mae     standard   0.251    10 0.00998 Preprocessor1_M…
 5            1 8.25e- 8 rmse    standard   0.312    10 0.0114  Preprocessor1_M…
 6            1 8.25e- 8 rsq     standard   0.934    10 0.00549 Preprocessor1_M…
 7            1 2.15e- 2 mae     standard   0.262    10 0.0108  Preprocessor1_M…
 8            1 2.15e- 2 rmse    standard   0.326    10 0.0130  Preprocessor1_M…
 9            1 2.15e- 2 rsq     standard   0.928    10 0.00588 Preprocessor1_M…
10            2 6.81e-10 mae     standard   0.202    10 0.00575 Preprocessor1_M…
# ℹ 65 more rows</code></pre>
</div>
</div>
<p>The model metrics show the mean metric (either mae, rmse, or rsq) when using both hyperparameters after applying it to the 10 folds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_best</span>(model_params, <span class="at">metric =</span> <span class="st">"mae"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 8
  hidden_units       penalty .metric .estimator  mean     n std_err .config     
         &lt;int&gt;         &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;       
1            7 0.00000147    mae     standard   0.186    10 0.00490 Preprocesso…
2            8 0.00121       mae     standard   0.191    10 0.00552 Preprocesso…
3            5 0.000178      mae     standard   0.192    10 0.00546 Preprocesso…
4           10 0.000000215   mae     standard   0.192    10 0.00505 Preprocesso…
5            9 0.00000000178 mae     standard   0.192    10 0.00715 Preprocesso…</code></pre>
</div>
</div>
<p>Different sets of the hidden units and penatly parameters behave similarly and give similar mae means. The best hyperparameter set is hidden units of 7 and 1.467799e-06 penalty (amount of regularization). The mean mean absolute error of using this set is 0.189. A low mae is ideal because it shows lower amount of error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>hp_best <span class="ot">&lt;-</span> <span class="fu">select_best</span>(model_params, <span class="at">metric =</span> <span class="st">"mae"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(hp_best)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  hidden_units    penalty .config              
         &lt;int&gt;      &lt;dbl&gt; &lt;chr&gt;                
1            7 0.00000147 Preprocessor1_Model19</code></pre>
</div>
</div>
</section>
</section>
<section id="finalize-your-model" class="level1">
<h1>Finalize your model</h1>
<section id="finalize-workflow" class="level2">
<h2 class="anchored" data-anchor-id="finalize-workflow">Finalize Workflow</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>final_wf <span class="ot">&lt;-</span> <span class="fu">finalize_workflow</span>(nn_wf, hp_best)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="final-model-verification" class="level1">
<h1>Final Model Verification</h1>
<section id="implement-the-last-fit" class="level2">
<h2 class="anchored" data-anchor-id="implement-the-last-fit">Implement the last fit</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>final_fit <span class="ot">&lt;-</span> <span class="fu">last_fit</span>(final_wf, camels_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpret-metrics" class="level2">
<h2 class="anchored" data-anchor-id="interpret-metrics">Interpret Metrics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(final_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  .metric .estimator .estimate .config             
  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 rmse    standard       0.353 Preprocessor1_Model1
2 rsq     standard       0.935 Preprocessor1_Model1</code></pre>
</div>
</div>
<p>This final model performs well on the testing data. An indicator of a well performing model is a high r-squared and a low root mean squared error. The final model has a r-squared value of 0.94 which means 94% of the variance of streamflow can be explained by the predictors (slope mean and runoff ratio). This model also has a root mean squared error value of 0.35, which means the models predictions are different from the actual values by 0.35 units. The final model performs a bit worse on the testing data than the training data, however it is still a good model.</p>
</section>
<section id="plot-predictions" class="level2">
<h2 class="anchored" data-anchor-id="plot-predictions">Plot Predictions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_predictions</span>(final_fit) <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> logQmean)) <span class="sc">+</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span> </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span> </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"lightblue"</span>)) <span class="sc">+</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Final Fit"</span>, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Predicted (Log10)"</span>, </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Actual (Log10)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hyperparameter-tuning_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="final-figure" class="level1">
<h1>Final Figure</h1>
<section id="augment-data-calculate-residuals" class="level2">
<h2 class="anchored" data-anchor-id="augment-data-calculate-residuals">Augment Data &amp; Calculate Residuals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>full_pred <span class="ot">=</span> <span class="fu">fit</span>(final_wf, <span class="at">data =</span> camels) <span class="sc">|&gt;</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> camels) <span class="sc">|&gt;</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> .pred <span class="sc">-</span> logQmean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="map-predicted-q-and-residuals" class="level2">
<h2 class="anchored" data-anchor-id="map-predicted-q-and-residuals">Map Predicted Q and Residuals</h2>
<p>Map of Predictions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pred_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> full_pred, <span class="fu">aes</span>(<span class="at">x =</span> gauge_lon, <span class="at">y =</span> gauge_lat)) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">borders</span>(<span class="st">"state"</span>, <span class="at">colour =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> .pred)) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"lightblue"</span>, <span class="at">high =</span> <span class="st">"darkblue"</span>) <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_map</span>()</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hyperparameter-tuning_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Map of Residuals</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>resid_map <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> full_pred, <span class="fu">aes</span>(<span class="at">x =</span> gauge_lon, <span class="at">y =</span> gauge_lat)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">borders</span>(<span class="st">"state"</span>, <span class="at">colour =</span> <span class="st">"gray50"</span>) <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> diff)) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="at">low =</span> <span class="st">"green"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  ggthemes<span class="sc">::</span><span class="fu">theme_map</span>()</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resid_map)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hyperparameter-tuning_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>combined_maps <span class="ot">&lt;-</span> pred_map <span class="sc">+</span> resid_map</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(combined_maps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="hyperparameter-tuning_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>